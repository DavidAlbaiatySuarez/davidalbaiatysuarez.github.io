package detectors;

import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.util.ArrayList;
import java.util.List;

import com.github.javaparser.JavaParser;
import com.github.javaparser.ast.CompilationUnit;
import com.github.javaparser.ast.visitor.VoidVisitor;

public class Driver {
	
	public static void main(String[] args) {
	
		// private static final String FILE_PATH = "C:\\OOSE 2 ASSESSED EXERCISE 2";
	
		try {
			CompilationUnit cu = JavaParser.parse(new FileInputStream("Calculator.java"));
			VoidVisitor<List<String>> methodVisitor = new UselessControlFlowDetector();
			VoidVisitor<List<String>> recursionVisitor = new RecursionDetector();
			List<String> collector = new ArrayList<>();
			
			// Gets all the methods inside the class (as well as the className for all the methods)
			methodVisitor.visit(cu, collector);
			
			System.out.println("Useless Control Flows:");
			// TODO Add the name of the class for which the method belongs to:
			collector.forEach(statement -> {
				String[] temp = statement.split(",");
				Breakpoints uselessControlFlow = new Breakpoints(temp[0],
																temp[1],
																temp[2]
																);
				System.out.println(uselessControlFlow);
			});
			
			System.out.println("---------------------------------");
			System.out.println("Recursion: ");
			List<String> collectorRecursion = new ArrayList<>();
			recursionVisitor.visit(cu, collectorRecursion );
			collectorRecursion.forEach(statement -> {
				String[] temp = statement.split(",");
				Breakpoints recursionDetector = new Breakpoints(temp[0],
																temp[1],
																temp[2]
																);
				System.out.println(recursionDetector);
			});
			
			
		}catch (FileNotFoundException e) {
			e.printStackTrace();
		}
	}
}
